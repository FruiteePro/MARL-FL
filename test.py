import torch
from sklearn.decomposition import PCA
from Model.Resnet8 import ResNet_cifar


# 创建 ResNet 模型实例
resnet = ResNet_cifar(resnet_size=8, scaling=4, save_activations=False,
                      group_norm_num_groups=None, freeze_bn=False,
                      freeze_bn_affine=False, num_classes=10)

params = resnet.state_dict()

all_params = torch.cat([value.view(-1) for value in params.values()])

print(all_params.shape)


# # 打印一维张量的形状
# print(flattened_params)

# feature_matrix = flattened_params.detach().numpy()


# print(feature_matrix.shape)
# pca = PCA(n_components=100)
# pca.fit(feature_matrix)

# intermediate_matrix = pca.components_

# transformed_matrix = pca.transform(feature_matrix)

# print(transformed_matrix.shape)
# print(intermediate_matrix.shape)



reward_list: [
    [-0.8785360581269194, 
     -0.9398545254845537, 
     -0.9134906427467825, 
     -0.8209542722145036, 
     -0.8887867952342555, 
     -0.8490858486581, 
     -0.8934944881156417, 
     -0.8228798812007028, 
     -0.7496531860721665, 
     -0.7204845372585345, 
     -0.7154409437272637, 
     -0.7447115805365341, 
     -0.7190860840035123, 
     -0.7286174242326119, 
     -0.7071568608298624, 
     -0.7279393895822992, 
     -0.7195530107703116, 
     -0.6871376412276204, 
     -0.7097033155088666, 
     -0.6931937027099622, 
     -0.6907597531009031, 
     -0.693703667023831, 
     -0.6858337738195894, 
     -0.6777616737575498, 
     -0.6860949812920809, 
     -0.7732459851642938, 
     -0.6972497618265716, 
     -0.67883201342224, 
     -0.693321273332525, 
     -0.7752177534758125, 
     -0.6978786591443622, 
     -0.674122872858756, 
     -0.688306494531266, 
     -0.6722199395608396, 
     -0.8153583405956207, 
     -0.7569373710758371, 
     -0.6826822784950488, 
     -0.6790990423738845, 
     -0.671127564185196, 
     -0.6726286442291088, 
     -0.6701687497965192, 
     -0.673036839288875, 
     -0.6753403493175292, 
     -0.6689318797954387, 
     -0.7135411132465663, 
     -0.669344684302404, 
     -0.8642710852869115, 
     -0.6731727911723124, 
     -0.6896000995378151, 
     -0.6780295926225437, 
     -0.6770909008207913, 
     -0.7013764186708811, 
     -0.6690695385285815, 
     -0.666860113933456, 
     -0.6690695385285815, 
     -0.668104724048693, 
     -0.7570384369638827, 
     -0.7180326544228774, 
     -0.7458767993574704, 
     -0.6820217483141066, 
     -0.6893418087535677, 
     -0.6996326302637619, 
     -0.688306494531266, 
     -0.6714009988531286, 
     -0.6750701926723, 
     -0.6696196013115596, 
     -0.67290083085288, 
     -0.671127564185196, 
     -0.6947210541179002, 
     -0.6792324735821321, 
     -0.6672755016981653, 
     -0.7236056557180378, 
     -0.6752052990836617, 
     -0.6790990423738845, 
     -0.6749350300600756, 
     -0.8309408507663701, 
     -0.6792324735821321, 
     -0.674122872858756, 
     -0.686486385352374, 
     -0.6897291643871848, 
     -0.6679666639770381, 
     -0.8091911489899184, 
     -0.674122872858756, 
     -0.6716742061790602, 
     -0.6770909008207913, 
     -0.6708539019860862, 
     -0.6615534302368853, 
     -0.6719471863520098, 
     -0.6700315483075656, 
     -0.67398731618536, 
     -0.7160320528485071, 
     -0.6583005099057418, 
     -0.6749350300600756, 
     -0.6747998112236104, 
     -0.67883201342224, 
     -0.6622564788660906, 
     -0.6564480921275844, 
     -0.9231920209804433, 
     -0.950943095930536, 
     -0.6876576717469938, 
     -0.6521348641093518, 
     -0.6658888579648268, 
     -0.6735803077423755, 
     -0.6612718011841703, 
     -0.6640775780614947, 
     -0.6622564788660906, 
     -0.6769565787722387, 
     -0.7635183739055486, 
     -0.6772251670179892, 
     -0.6669986341106537, 
     -0.6745292047843965, 
     -0.7199026964514561, 
     -0.8331064620880115, 
     -0.6669986341106537, 
     -0.6625372892274661, 
     -0.6789655556616166, 
     -0.6669986341106537, 
     -0.6646359383328783, 
     -0.661694156942922, 
     -0.6492293362524231
     ], 
     [-0.858742438695502, 
      -0.8741654498254325, 
      -0.8562533738842079, 
      -0.8481414545356849, 
      -0.832619890675814, 
      -0.8573254418737256, 
      -0.803717970331607, 
      -0.8095875125909346, 
      -0.7866934754719832, 
      -0.8367448962195615, 
      -0.7897758961865714, 
      -0.7732459851642938, 
      -0.7851800329564296, 
      -0.7803010317054144, 
      -0.7775427534833739, 
      -0.7626315657909672, 
      -0.7823925280681966, 
      -0.7843744562480208, 
      -0.7568362631469285, 
      -0.7764297701176477, 
      -0.7753112183472426, 
      -0.7653796593208654, -0.7514169211525041, -0.7501732267523868, -0.7459824642515746, -0.7956378392304567, -0.752139548352424, -0.7589507242786743, -0.7666447225623503, -0.7550091114675033, -0.7532708635285396, -0.832759055651736, -0.7579461409993824, -0.7576439504124474, -0.7561273290305088, -0.7488188684064147, -0.7504847324868971, -0.7449238351878855, -0.752139548352424, -0.7449238351878855, -0.7524486023062611, -0.7470366997432678, -0.7514169211525041, -0.7475621756008286, -0.7504847324868971, -0.7441801708658073, -0.7456653376891784, -0.749236374222173, -0.7440737562630693, -0.7477720601796842, -0.742579295527853, -0.766158969031477, -0.7574422804569421, -0.7497572807377306, -0.7527572709047672, -0.7479817702540392, -0.7458767993574704, -0.744499149263282, -0.7440737562630693, -0.7494448668207523, -0.7475621756008286, -0.7512100695449793, -0.7576439504124474, -0.7424722150013133, -0.752036444650159, -0.7432208443249099, -0.7490277081321826, -0.7495490481058442, -0.7504847324868971, -0.7452418863200478, -0.7455595408784153, -0.7429002700358385, -0.7695381269797532, -0.7498613321205414, -0.744499149263282, -0.7529628361214488, -0.7532708635285396, -0.7589507242786743, -0.7513135168555327, -0.7491320628726243, -0.7484006674694812, -0.7462991953930098, -0.7836558523340462, -0.7477720601796842, -0.7542948503636873, -0.7604497872290509, -0.8303068775149992, -0.7744686334998875, -0.7647934731215531, -0.7458767993574704, -0.7432208443249099, -0.7453478152121604, -0.7415064836113584, -0.7472470212189288, -0.7479817702540392, -0.7440737562630693, -0.7478769370208534, -0.7435410188940952, -0.7462991953930098, -0.7475621756008286, -0.7498613321205414, -0.7490277081321826, -0.745771090509433, -0.7629275373855511, -0.7470366997432678, -0.7471418823486586, -0.7460880852100213, -0.7382611473117475, -0.7441801708658073, -0.7411837690396557, -0.746720889334406, -0.7513135168555327, -0.748609854900383, -0.7557212962252385, -0.750588481393933, -0.7561273290305088, -0.7669356902042692, -0.8061516984132489, -0.7834758274710073, -0.7529628361214488], [-0.9572520217530471, -0.9378456144579241, -0.9413855573498761, -0.9488598571747164, -0.939528465453743, -0.9281067566655872, -0.9422085451178938, -0.9209559871893767, -0.9232877918444292, -0.953967391735112, -0.9554737476349833, -0.9338172063930268, -0.9343654162929653, -0.942830083236803, -0.938947253818717, -0.9345017577667051, -0.913202337559763, -0.9441229370887606, -0.9185533031647941, -0.926687653128131, -0.9306615210163105, -0.9427825108548075, -0.9182818700399998, -0.9157628754946314, -0.9180095323243, -0.9316919224522642, -0.9261981904730919, -0.9234471446569716, -0.9523704740518822, -0.9305460767681993, -0.9174277973777244, -0.9170146776010977, -0.9186886814449511, -0.9524496424351083, -0.9327629611149412, -0.9201962694102697, -0.9190598125715984, -0.9281067566655872, -0.9126954895846143, -0.9248039859786492, -0.9225826894505544, -0.9288799573284793, -0.9222923738757753, -0.9323703358292388, -0.9334307372879114, -0.9237965566202311, -0.9150592887117499, -0.9141001156047394, -0.9204613437086514, -0.9107868616872172, -0.918823834703352, -0.917359087178589, -0.9202294519481905, -0.9140286363662661, -0.9142428958409795, -0.9186548579853254, -0.9124409567881052, -0.9197636382428455, -0.9173934494220988, -0.9139928744453121, -0.9301405061644932, -0.9135625692897139, -0.9137779903056986, -0.9388964504464603, -0.9188575879021477, -0.9137062430194715, -0.918349813009055, -0.9114522167805084, -0.9284051313762652, -0.9227756303507677, -0.9343927072735583, -0.9248977469045718, -0.9449761842604572, -0.9153414258910822, -0.9100791177946137, -0.9135985101323427, -0.91607758526558, -0.9132384281874076, -0.9301985894983898, -0.9148824756956647, -0.9140643834173474, -0.913849677939023, -0.9251783288096187, -0.9144210374441454, -0.9159728128654608, -0.9183158485886989, -0.9123316442625008, -0.9179413061999835, -0.9193957343340071, -0.9158679096629111, -0.9159378596729411, -0.9187900674640763, -0.9280768508879355, -0.9189587633140216, -0.9159028919407738, -0.9190598125715984, -0.9195297123500985, -0.9151652001731826, -0.9060654306199516, -0.9110462029128306, -0.9137062430194715, -0.9139928744453121, -0.9235107930576901, -0.9182478773570806, -0.9167727372239178, -0.9106383273694025, -0.9106011551653354, -0.9149532450258329, -0.9165300914792777, -0.9152709795749999, -0.9114522167805084, -0.9121126096293527, -0.9179413061999835, -0.921382189260249, -0.9201298629193874, -0.9242389571421816, -0.9100791177946137, -0.9240180788620871, -0.9122586934389876, -0.9136703469910089]]